<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Complaint Detail</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        /* Animated Gradient Background */
        body {
            background: linear-gradient(135deg, #9b5de5, #f15bb5, #fee440);
            background-size: 300% 300%;
            animation: bgMove 10s ease infinite;
            min-height: 100vh;
        }

        @keyframes bgMove {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Glassmorphism Cards */
        .glass-card {
            backdrop-filter: blur(12px);
            background: rgba(255, 255, 255, 0.75);
            border-radius: 20px;
            transition: 0.3s;
            animation: fadeIn 1s ease-out;
        }

        .glass-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Badge Styling */
        .status-badge {
            font-size: 14px;
            padding: 7px 12px;
            border-radius: 12px;
        }

        /* Inputs & Buttons */
        .form-control, .form-select {
            border-radius: 12px;
            transition: 0.3s;
        }
        .form-control:focus, .form-select:focus {
            border-color: #9b5de5;
            box-shadow: 0px 0px 8px rgba(155, 93, 229, 0.5);
        }

        .btn-custom {
            background: #9b5de5;
            padding: 10px;
            border-radius: 12px;
            border: none;
            transition: 0.3s;
        }

        .btn-custom:hover {
            background: #7a3fc4;
            transform: scale(1.04);
        }

        /* Header */
        .card-header-title {
            color: #7a3fc4;
            font-weight: 700;
        }
    </style>
</head>

<body>

<div class="container mt-4">

    <a href="{% url 'admin-dashboard' %}" class="btn btn-dark shadow mb-4" style="border-radius: 12px;">
        &larr; Back to Dashboard
    </a>

    <div class="row">

        <!-- LEFT: Complaint Details -->
        <div class="col-md-8">
            <div class="glass-card shadow p-0 mb-4">

                <div class="p-3 border-bottom" style="background: rgba(255,255,255,0.55); border-radius: 20px 20px 0 0;">
                    <h4 class="card-header-title mb-0">
                        {{ c.subject }}

                        <span class="status-badge float-end
                            {% if c.status == 'Resolved' %} bg-success text-white
                            {% elif c.status == 'Rejected' %} bg-danger text-white
                            {% elif c.status == 'In Process' %} bg-info text-dark
                            {% else %} bg-warning text-dark {% endif %}
                        ">
                            {{ c.status }}
                        </span>
                    </h4>
                </div>

                <div class="card-body">

                    <h6 class="text-secondary fw-bold mb-2">Student Information</h6>
                    <p class="mb-2">
                        <strong>Name:</strong> {{ c.name }} |
                        <strong>Roll No:</strong> {{ c.roll_number }}
                    </p>

                    <p class="mb-2">
                        <strong>Department:</strong> {{ c.department }} |
                        <strong>Category:</strong> {{ c.complaint_category }}
                    </p>

                    <hr>

                    <h6 class="text-secondary fw-bold mb-2">Description</h6>
                    <p class="fs-6">{{ c.description }}</p>

                    {% if c.attachment %}
                        <hr>
                        <h6 class="text-secondary fw-bold mb-2">Attachment</h6>
                        <img src="{{ c.attachment.url }}" class="img-fluid rounded shadow-sm" style="max-height: 300px;">
                    {% endif %}

                </div>
            </div>
        </div>

        <!-- RIGHT: Update Section -->
        <div class="col-md-4">
            <div class="glass-card shadow p-3">

                <h5 class="text-center fw-bold mb-3" style="color:#7a3fc4;">
                    Update Status & Remarks
                </h5>

                <form method="POST">
                    {% csrf_token %}

                    <label class="form-label fw-bold">Change Status:</label>
                    <select name="status" class="form-select mb-3">
                        <option value="Pending"      {% if c.status == 'Pending' %}selected{% endif %}>Pending</option>
                        <option value="In Process"   {% if c.status == 'In Process' %}selected{% endif %}>In Process</option>
                        <option value="Resolved"     {% if c.status == 'Resolved' %}selected{% endif %}>Resolved</option>
                        <option value="Rejected"     {% if c.status == 'Rejected' %}selected{% endif %}>Rejected</option>
                    </select>

                    <label class="form-label fw-bold">Admin Remarks:</label>
                    <textarea name="admin_remark" class="form-control mb-4" rows="4"
                        placeholder="Write remarks here...">{{ c.admin_remark }}</textarea>

                    <button type="submit" class="btn-custom text-white w-100">
                        Update Status
                    </button>
                </form>

            </div>
        </div>

    </div>
</div>

</body>
</html>
